# RTD C++/ATL/CMake with embedded TLB â€” v5 (Clean shutdown)

This version adds a guarded shutdown to prevent Debug assertions when Excel closes:
- Stops the timer
- Destroys the hidden window on the STA thread
- Releases the Excel callback
- Uses an atomic stopping flag to avoid late UpdateNotify calls

## Build (x64 example)
  cmake -S rtd_v5 -B build -G "Visual Studio 17 2022" -A x64
  cmake --build build --config Debug

## Register per-user (no admin)
  cmake --build build --config Debug --target register
  :: or: regsvr32 /n /i:user build\Debug\MyRtd.dll

## Use in Excel
  Application.RTD.ThrottleInterval = 1000   ' optional, once
  =RTD("MyCompany.RtdTickCPP",, "RAND1S")

## Notes
- Bitness must match Excel.
- Exports are defined in MyRtd.def (DllInstall included).
- Type library is generated by MIDL and embedded in the DLL; ATL registers it automatically.
